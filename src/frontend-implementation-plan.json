{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Auth-first initial load with clean post-login transition",
  "requirements": [
    {
      "id": "REQ-1",
      "summary": "Auto-open the existing AuthEntryDialog on initial load for unauthenticated users so auth is the first flow before main content.",
      "acceptanceCriteria": [
        "When a user visits the app while not authenticated, the Sign In / Sign Up dialog is shown automatically without requiring any click.",
        "The main content (Hero/Generator/other sections) is not the primary focus until the auth dialog is dismissed or authentication completes."
      ],
      "file_operations": [
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Introduce a single, app-level AuthEntryDialog open state and an initial-load effect that automatically opens it once auth initialization completes and the user is unauthenticated; update isAuthenticated to be based on non-anonymous identity (not on loginStatus) so returning sessions are treated as authenticated correctly."
        },
        {
          "path": "frontend/src/sections/HeroSection.tsx",
          "operation": "modify",
          "description": "Remove the HeroSection-local AuthEntryDialog state/rendering and instead rely on App-managed dialog state (via props/callback) so the initial auth-first modal cannot be bypassed by duplicate dialog instances."
        },
        {
          "path": "frontend/src/components/AuthControls.tsx",
          "operation": "modify",
          "description": "Refactor AuthControls to stop owning its own AuthEntryDialog instance and instead trigger the App-managed AuthEntryDialog (e.g., via an onOpenAuthDialog callback/controlled open prop), preventing multiple dialogs and ensuring the initial auth-first flow is consistent."
        }
      ]
    },
    {
      "id": "REQ-2",
      "summary": "After successful Internet Identity login from the initial AuthEntryDialog, close the dialog automatically and continue into the app while preserving existing post-auth behaviors; keep failures in-dialog with existing error UI.",
      "acceptanceCriteria": [
        "After completing Sign In/Sign Up successfully, the auth dialog closes automatically.",
        "The user can access the full app UI after successful authentication without needing a manual refresh.",
        "If authentication fails, an error is shown in the dialog (using existing error UI) and the user remains in the auth flow."
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/auth/AuthEntryDialog.tsx",
          "operation": "modify",
          "description": "Adjust AuthEntryDialog success handling so that upon detecting authenticated identity it automatically calls onAuthSuccess (if provided) and closes itself via onOpenChange(false) after a short delay; also fix Dialog onOpenChange wiring so it respects the requested open state (not always forcing close) while keeping existing in-dialog error display intact."
        },
        {
          "path": "frontend/src/App.tsx",
          "operation": "modify",
          "description": "Provide an App-level onAuthSuccess handler for the initial auth-first dialog that closes the dialog and preserves existing post-auth behavior (e.g., scrolling to the generator and focusing the name input when appropriate), without requiring a manual refresh."
        }
      ]
    }
  ]
}