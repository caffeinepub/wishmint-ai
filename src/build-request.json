{
  "kind": "build_request",
  "title": "Add Google login (via Internet Identity)",
  "priority": "normal",
  "requirements": [
    {
      "id": "REQ-19",
      "text": "Implement a user login/logout UI using the existing Internet Identity authentication hook, and present it to users as the app’s Google-based login alternative (since direct Google OAuth is not supported in this stack).",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "Add login system with google"
        ]
      },
      "acceptanceCriteria": [
        "A visible sign-in control exists on the landing experience (e.g., in the Hero section area or a simple top bar) with English text such as “Sign in”.",
        "Clicking “Sign in” triggers the existing Internet Identity login flow via `useInternetIdentity().login()` (no direct Google OAuth implementation).",
        "When signed in, the UI changes to show an authenticated state and provides a “Sign out” action wired to `useInternetIdentity().clear()`.",
        "If login fails, an English error message is shown (using the existing `loginError` from `useInternetIdentity`)."
      ]
    },
    {
      "id": "REQ-20",
      "text": "Display basic authenticated user info in the UI after login, using the active identity principal as the user identifier, and keep the app usable when not logged in.",
      "target": "frontend",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "Add login system with google"
        ]
      },
      "acceptanceCriteria": [
        "When authenticated, the UI displays the user’s Principal (or a safely shortened version) somewhere near the auth controls.",
        "When not authenticated, the app continues to function for generating/copying/sharing wishes as it does today.",
        "Auth UI does not block core offline functionality after the app is loaded (no dependency on external APIs for generation)."
      ]
    },
    {
      "id": "REQ-21",
      "text": "Add a minimal backend method to verify authentication wiring by returning the caller principal, and ensure the frontend can call it using the authenticated actor when logged in.",
      "target": "both",
      "source": {
        "messageIds": [
          "msg-user-1"
        ],
        "quotes": [
          "Add login system with google"
        ]
      },
      "acceptanceCriteria": [
        "`backend/main.mo` exposes a query method that returns the caller’s principal (e.g., for a “Who am I” check).",
        "When logged in, frontend calls the method using the identity-bound actor from the existing `useActor` hook and displays the returned principal (or logs it in a non-intrusive way).",
        "When not logged in, calling the method returns the anonymous principal (or behaves consistently with anonymous identity), and the UI handles this gracefully."
      ]
    }
  ],
  "constraints": [
    "Do not implement direct Google OAuth / Google Sign-In SDK integration; only Internet Identity authentication is supported in this platform.",
    "Do not edit files under `frontend/src/hooks/useInternetIdentity.ts`, `frontend/src/hooks/useInternetIdentity.tsx`, `frontend/src/hooks/useActor.ts`, `frontend/src/main.tsx`, or anything under `frontend/src/components/ui` (compose new components instead).",
    "Keep all Motoko backend logic in the single actor at `backend/main.mo`; do not introduce additional backend services.",
    "Use English for any new user-facing text."
  ],
  "nonGoals": [
    "Building role-based access control, user profiles, or storing user data.",
    "Restricting WishMint AI generation features to logged-in users (unless explicitly requested later).",
    "Integrating third-party auth providers beyond Internet Identity."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}